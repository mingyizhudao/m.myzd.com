$(function(){var f=$("#smsLogin-form"),g=f.attr("data-checkCode"),d=$("#btnSmsSubmit");$.validator.addMethod("isMobile",function(m,k){var l=m.length;var j=/^(13[0-9]{9})|(18[0-9]{9})|(14[0-9]{9})|(17[0-9]{9})|(15[0-9]{9})$/;return this.optional(k)||(l==11&&j.test(m))},"请填写正确的手机号码");$.validator.addMethod("isPassword",function(m,k){var l=m.length;var j=/^[a-zA-Z0-9_]+$/;return this.optional(k)||(j.test(m))},"请填写字母、数字或下划线");d.click(function(){var j=i.form();if(j){var k=$("#UserDoctorMobileLoginForm_captcha_code").val();f.ajaxSubmit({url:g+"?co_code="+k,success:function(l){if(l.status=="ok"){b()}else{$("#UserDoctorMobileLoginForm_captcha_code-error").remove();$("#captchaCode").parents("div.input").append('<div id="UserDoctorMobileLoginForm_captcha_code-error" class="error">'+l.error+"</div>");$("#UserDoctorMobileLoginForm_captcha_code").focus()}}})}});var i=f.validate({rules:{"UserDoctorMobileLoginForm[username]":{required:true,isMobile:true},"UserDoctorMobileLoginForm[captcha_code]":{required:true},"UserDoctorMobileLoginForm[verify_code]":{required:true,digits:true,maxlength:6,minlength:6}},messages:{"UserDoctorMobileLoginForm[username]":{required:"请输入手机号码",isMobile:"请输入正确的中国手机号码!"},"UserDoctorMobileLoginForm[captcha_code]":{required:"请输入图形验证码"},"UserDoctorMobileLoginForm[verify_code]":{required:"请输入短信验证码",digits:"请输入正确的短信验证码",maxlength:"请输入正确的短信验证码",minlength:"请输入正确的短信验证码"}},errorElement:"div",errorPlacement:function(j,k){k.parents("div.input").find("div.error").remove();k.parents("div.input").find("div.errorMessage").remove();j.appendTo(k.parents("div.input"))}});function b(){disabledBtn(d);var l=f.attr("data-actionUrl");var o=f.attr("data-returnUrl");var k=f.serializeArray();var j=structure_formdata("UserDoctorMobileLoginForm",k);var m=do_encrypt(j,pubkey);var n={param:m};$.ajax({type:"post",url:l,data:n,success:function(p){console.log(p);if(p.status=="ok"){enableBtn(d);location.href=o}else{f.find("div.error").remove();for(error in p.errors){errerMsg=p.errors[error];inputKey="#UserDoctorMobileLoginForm_"+error;console.log(inputKey);$(inputKey).focus();$(inputKey).parents("div.input").append("<div class='error'>"+errerMsg+"</div> ")}enableBtn(d)}},error:function(p,r,q){enableBtn(d);console.log(p);console.log(r);console.log(q)},complete:function(){}})}var h=$("#pawLogin-form"),a=$("#btnPawSubmit");a.click(function(){var j=c.form();if(j){e()}});var c=h.validate({rules:{"UserLoginForm[username]":{required:true,isMobile:true},"UserLoginForm[password]":{required:true,isPassword:true,minlength:4}},messages:{"UserLoginForm[username]":{required:"请输入手机号码",isMobile:"请输入正确的中国手机号码!"},"UserLoginForm[password]":{required:"请输入密码",minlength:"密码至少4位"}},errorElement:"div",errorPlacement:function(j,k){k.parents("div.input").find("div.error").remove();k.parents("div.input").find("div.errorMessage").remove();j.appendTo(k.parents("div.input"))}});function e(){disabledBtn(a);var l=h.attr("data-actionUrl");var o=h.attr("data-returnUrl");var k=h.serializeArray();var j=structure_formdata("UserLoginForm",k);var m=do_encrypt(j,pubkey);var n={param:m};$.ajax({type:"post",url:l,data:n,success:function(p){console.log(p);if(p.status=="ok"){enableBtn(a);location.href=o}else{h.find("div.error").remove();for(error in p.errors){errerMsg=p.errors[error];inputKey="#UserLoginForm_"+error;$(inputKey).focus();$(inputKey).parents("div.input").append("<div class='error'>"+errerMsg+"</div> ")}enableBtn(a)}},error:function(p,r,q){enableBtn(a);console.log(p);console.log(r);console.log(q)},complete:function(){}})}});